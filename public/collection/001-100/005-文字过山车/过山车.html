<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="lijinbo" />
    <title>è¿‡å±±è½¦</title>
    <style>
      .box {
        padding: 20px;
      }
    </style>
  </head>

  <body>
    <div class="box">
      <div id="ulBox"></div>
    </div>
    <script type="text/javascript">
      const count = 80
      const W = document.documentElement.clientWidth
      const H = document.documentElement.clientHeight
      let scrollTop = 0
      // å»¶è¿Ÿå‡½æ•°
      function sleep(t) {
        return new Promise((a) => setTimeout(a, t))
      }
      let rangeMax = Math.floor((W - 100) / 16)
      const docList = 'ğŸ˜€,ğŸ˜,ğŸ˜‚,ğŸ¤£,ğŸ˜ƒ,ğŸ˜„,ğŸ˜…,ğŸ˜†,ğŸ˜‰,ğŸ˜Š,ğŸ˜‹,ğŸ˜,ğŸ˜,ğŸ˜˜,ğŸ¥°,ğŸ˜—,ğŸ‘©,ğŸ‘¨,ğŸ§‘,ğŸ‘±,ğŸ˜–'.split(',')
      const range = { min: 1, max: rangeMax } // æ–‡æ¡ˆåŒºåŸŸ(æ³¢å³°ï¼Œæ³¢è°·)
      const randomToggleNum = 0.3 // éšæœºåè½¬å‡ ç‡
      let docCount = 1 // æ–‡æ¡ˆå åŠ åˆå§‹é‡
      let toggle = true // åè½¬å€¼ true å¢åŠ  false
      // è¾“å‡ºæ–‡æ¡ˆ
      function resultDoc() {
        let result = '',
          len = docList.length
        for (let i = 0; i < docCount; i++) {
          let item = '//'
          if (i == docCount - 1) {
            item = docList[~~(Math.random() * len)]
          }
          result += item
        }
        scrollTop += 21
        document.documentElement.scrollTop = scrollTop
        renderDoc(result)
      }

      // æ–‡å­—å åŠ çš„èŒƒå›´
      function getRange() {
        // éšæœºåè½¬
        if (Math.random() < randomToggleNum) {
          toggle = Math.random() < 0.5
        }
        // æ–‡æ¡ˆåŒºåŸŸåˆ¤æ–­
        if (docCount >= range.max) {
          toggle = false
        } else if (docCount <= range.min) {
          toggle = true
        }
      }
      // æ¸²æŸ“åˆ°é¡µé¢
      function renderDoc(doc) {
        var ulBox = document.getElementById('ulBox')
        var div = document.createElement('div')
        div.innerText = doc
        ulBox.appendChild(div)
      }

      async function run() {
        for (let i = 1; i < count; i++) {
          getRange()
          toggle ? docCount++ : docCount--
          resultDoc()
          await sleep(30)
        }
      }
      run()
    </script>
  </body>
</html>
